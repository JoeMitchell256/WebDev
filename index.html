<!DOCTYPE html>
<html>
  <head>
    <title>Visualizing Fourier Coefficients</title> <!-- Title of our website in browser -->
    <link rel="stylesheet" type="text/css" href="style.css">
    <canvas id="back" width="1420" height="500" style="border:1px solid #000000"></canvas>
    <canvas id="myCanvas" width="1420" height="500" style="border:1px solid #000000"></canvas>
    <script> <!-- type="text/javascript" src="script.js" -->
      
      
      <!-- Beginning of graph construction -->
      
      <!-- Develop textboxes for user input -->
      
      var c = document.getElementById("myCanvas");
      var ctx = c.getContext("2d");
      
      function getInputValue(){
        
        var pulsefunction = document.getElementById("pulse").value;
        var n = document.getElementById("n").value;
      
        <!-- Place everything in here? -->
        
        //Take input as an array of values split on single space
        
        var i = 0;
        var pulsearray = pulsefunction.split(" ");
      
        //In a for loop find the maximum/minimum value, use the absolute value so you'll only be using positive numbers as reference
        
        var max = -Infinity;
        
        for(i = 0; i < pulsearray.length; i++){
          if(Math.abs(parseInt(pulsearray[i])) > max){
            max = Math.abs(parseInt(pulsearray[i]));
          }
        }
        
        
        //By this point we should know our y scale. Whatever our max value is we should have that be our max positive/negative range. 
        //This might not work as I am expecting it to work, however thats alright we'll do it now, then change it later if so.
        
      
        <!-- End of input reading -->
        
        c = document.getElementById("myCanvas");
        ctx = c.getContext("2d");
        
        ctx.clearRect(0,0,1420,500);
        ctx.beginPath(); //Apparently we need this line???
        
        //We should probably draw the y and x axis here, so that we can properly scale the graph first...
        // I'd love to do this, but javascript wont let me...
        
        <!-- This is the start of the square wave -->
        <!-- Any state transitions will require 3 lines, not 2. -->
        <!-- pi/2 and 2pi/2 are tied to 5pi/2 and 6pi/2, and 9pi/2 and 10pi/2 -->
        
        <!-- Y-axis modular variables -->
        
        var ycenter = 250;
        var ytop = 50;
        var yend = 450;
        
        <!-- Y-axis modular variables end -->
        
        <!-- X-axis modular variables -->
        
        var xstart = 100;
        var xend = 1400;
        
        <!-- X-axis modular variables end -->
        
        <!-- Modular Square Wave for 3 periods! -->
        
        var x_shift = xstart;
        var y_shift = ycenter;
        
        var pc = 0;
        i = 0;
        for(pc = 0; pc < 3; pc++){
          for(i = 0; i < pulsearray.length; i++){
            ctx.moveTo(x_shift,y_shift);
            y_shift = ( ( (ycenter-ytop)/(0-parseInt(max)) ) * (pulsearray[i]) ) + ycenter;
            ctx.lineTo(x_shift,y_shift);
            ctx.moveTo(x_shift,y_shift);
            x_shift += 450/(pulsearray.length);
            ctx.lineTo(x_shift,y_shift);
          }
        }
        
        <!-- End of Square Wave drawing -->
        
        
        <!-- This is where the points must be drawn!!!  -->
        <!-- This section of the program will plot the points for the Fourier Series! -->
        <!-- For sake of simplicity I'm going to hold off on the "0000" and "1111" waves -->

        
        //We need a robust way to calculate the integrals for the fourier coefficients
        
        //a_0 = (1/(2*Math.PI)) * Integral {0,2*Math.PI}, we should do it seperately for each interval (pi/2 intervals)
        // Since we know that the input must be scalar we know the integral of this function:
        //a_0 = (1/(2*Math.PI)) * t {0,2*Math.PI} or
        //a_0 = (1/(2*Math.PI)) * [ s*t {0,pi/2} + s*t {pi/2,pi} + s*t {pi,3pi/2} + s*t {3pi/2,2pi} 
        
        //Upper limit - Lower limit
        
        //General Form for a_0 START ************************************
        //Average of the pulses
        
        var a0 = 0;
        
        for(m=0; m<pulsearray.length; m++){
           a0 += parseInt(pulsearray[m]); //a_0 portion
        }
        
        a0 = a0/(pulsearray.length); //division by 4 was not modular
        
        //General Form for a_0  END ************************************
        
        //General Form for a_n  START ************************************
        
        //No matter what the scenario, the integral always comes out the same. I will provide my handcalculations if necessary.
        function a_n(upper,lower,s,n){
          return ( ( Math.sin(upper*n) - Math.sin(lower*n) ) * parseInt(s) )/(Math.PI*n);
        }
        
        var aN = 0;
        
        //General Form for a_n  END ************************************
        
        //General Form for b_n  START ************************************
        
        function b_n(upper,lower,s,n){//Same as a_n but now its cos instead of sin from handcalculations
          return ( ( Math.cos(upper*n) - Math.cos(lower*n) ) * parseInt(s) )/(-1*Math.PI*n);
        }
        
        
        var bN = 0;
        
        
        //General Form for b_n END **************************************
        
        //Overall f(t) = a_0 + a_n*cos(n*t) + b_n*sin(n*t)
        //Now we can combine all three for loops into one just below this line for simplicity:
        
        //Test the single test input : "5 4 -3 1"
        
        var p = 0;
        var y = a0;
        var z = 0;
        var m = 0;
        n = parseInt(n);
        
        var test2 = 0;
        
        //We need to make this modular. If we have 3 pulses, then we need to divide 2pi by 3, so instead of pi/2 we'll have pi/3's
        //We also do not know how many divisions we'll have, so we need to modulate it.
        
        for(p = 0; p<13500; p++){
            for(z = 0; z<n; z++){ //Include n number of terms in the fourier series expansion
              //Now instead of having 4, we should have n, different pulses...
              
              for(i = 0; i < pulsearray.length; i++){
                aN += parseInt(pulsearray[i]) *  ( Math.sin( ( (z+1) * 2 * Math.PI/(pulsearray.length) ) * (i+1) ) - Math.sin( ( (z+1) * 2 * Math.PI/(pulsearray.length) ) * i ) ) / ( (z+1) * Math.PI );
                bN += parseInt(pulsearray[i]) *  ( Math.cos( ( (z+1) * 2 * Math.PI/(pulsearray.length) ) * (i+1) ) - Math.cos( ( (z+1) * 2 * Math.PI/(pulsearray.length) ) * i ) ) / ( -1 * (z+1) * Math.PI );
              }
              y += aN*Math.cos((z+1)*(p+1)*(Math.PI/2250)) + bN*Math.sin((z+1)*(p+1)*(Math.PI/22500));
              //Reset aN and bN in here?
              aN = 0;
              bN = 0;
            }
            var y_pos = ( ( (ycenter-ytop)/(0-parseInt(max)) ) * y ) + ycenter;//This y scale converter should provide the proper canvas point y position for the point placement 

            test2 = bN;
          
            ctx.fillRect(xstart + 1*(p+1),y_pos,3,3); //Shift 1 pixel every point for 1350 total points. We need a y scale converter though...
            ctx.stroke();
            
            y = a0;
         }
        
        
        //To develop the y scale converter we need to know the position of the Max/Min element (This should be at the very top and/or very bottom of the y axis)
        //Max y coordinate: 20  Min y coordinate: 480, so we should have 3 points really, Max, Min, center
        //Center y coordinate: 250
        
        // (max,480) , (0,250)
        //We can make a line like last time with 2 points the y intercept and the max for simplicity:
        //y = mx + b
        //b = 250
        //m = (max-0)/(480-250)
        //y = ( (250-20) )/(0-max)  * y_ + 250
        
        
        <!-- This is the end of the fourier series expansion section -->
        

        <!-- So this means that each interval is in 450 pixels, so the text will look like pi/2 , 2pi/2, 3pi/2, ... until 12pi/2 -->

        ctx.font = "15px Courier New";

        <!-- From 0 to 2pi -->

        ctx.fillText("pi/2",50+(450/4),ycenter + 30);
        ctx.fillText("2pi/2",50+(450/2),ycenter + 30);
        ctx.fillText("3pi/2",50+((450*3)/4),ycenter + 30);
        ctx.fillText("4pi/2",50+450,ycenter + 30);

        <!-- From 2pi to 4pi -->

        ctx.fillText("5pi/2",50+(450/4)+450,ycenter + 30);
        ctx.fillText("6pi/2",50+(450/2)+450,ycenter + 30);
        ctx.fillText("7pi/2",50+((450*3)/4)+450,ycenter + 30);
        ctx.fillText("8pi/2",50+900,ycenter + 30);

        <!-- From 4pi to 6pi -->

        ctx.fillText("9pi/2",50+(450/4)+900,ycenter + 30);
        ctx.fillText("10pi/2",50+(450/2)+900,ycenter + 30);
        ctx.fillText("11pi/2",50+((450*3)/4)+900,ycenter + 30);
        ctx.fillText("12pi/2",50+1350,ycenter + 30);


        <!-- Y-axis scale -->
        ctx.fillText("0", xstart - 10, ycenter);
        for(i = 0; i < pulsearray.length; i++){
          ctx.fillText(pulsearray[i], xstart - 10, ( ( (ycenter-ytop)/(0-parseInt(max)) ) * parseInt(pulsearray[i]) ) + ycenter);
        }
        ctx.fillText("f(t)",xstart - 50,ycenter - 20);

        <!-- End of Y-axis creation -->
        
        <!-- Draw new axis for both graphs -->
        
        <!-- New x-axis -->
        
        ctx.moveTo(xstart-50,ycenter);
        ctx.lineTo(xend,ycenter); <!-- The total x-axis distance is from 1400-50 = 1350. If we want 3 periods we want to to take intervals of 1350/3 = 450 -->
        ctx.stroke();
        
        <!-- End new x-axis -->
      
        ctx.moveTo(xstart,ytop);
        ctx.lineTo(xstart,yend); <!-- The total x-axis distance is from 1400-50 = 1350. If we want 3 periods we want to to take intervals of 1350/3 = 450 -->
        ctx.stroke();
        ctx.fillText("time (seconds)",(xstart + xend)/2,yend + 30);
        
        <!-- End of X-axis creation -->
        
        
      }
      
      
    </script>
  </head>
  <body>
    <div class="container" style = "position:fixed; left:500px; top: 500px;">
      <div class="box-1">
        <h1>Visualizing Fourier Coefficients</h1> <!-- This is the actual 'Title' of the page for the website -->
        <p>In the bottom left textbox enter a pulsefunction defined by any number of +/- scalar values seperated by a space. In the box next to it enter a number of terms for the fourier series expansion.
        When ready press the submit button on the far left.</p>
        <input type="text" placeholder="Enter pulsefunction here" id="pulse">
        <input type="text" placeholder="Enter a number of terms here" id="n">
        <button type="button" onclick="getInputValue();">Submit</button>
      </div>
    </div>
  </body>
</html>

